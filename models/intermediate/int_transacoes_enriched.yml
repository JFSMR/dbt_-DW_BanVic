version: 2

models:
  - name: int_transacoes_enriched
    columns:
      - name: id_transacao
     
        tests:
          - unique
          - not_null
          

      - name: id_surrogate 
        tests:
          - unique
          - not_null

      - name: id_num_conta
        tests:
         - not_null

      - name: id_cliente  
      - name: nome_clientes

      - name: data_transacao
        tests:
         - not_null

      - name: nome_transacao

      - name: valor_transacao
        tests:
         - not_null

      - name: tipo_conta

      - name: data_abertura

      - name: saldo_total
        tests:
          - not_null
          - dbt_utils.expression_is_true:          
              expression: "saldo_total >= 0"

      - name: saldo_disponivel
        tests:
          - not_null
          - dbt_utils.expression_is_true: 
              expression: "saldo_disponivel >= 0"

      - name: data_ultimo_lancamento

      - name: id_cliente

      - name: id_colaborador

      - name: id_colaborador

      - name: dia_semana
        tests:

          - accepted_values:
              values:  [1, 2, 3, 4, 5, 6, 7]
      - name: tipos_mes
        tests:
          - accepted_values:
              values: ['par', 'impar']

      - name: fl_ultimos_6m        
        tests:
          - accepted_values:
              values: [1, 0]

      - name: direcao_transacao
        tests:
          - accepted_values:
              values: ['entrada', 'saque']
  

 